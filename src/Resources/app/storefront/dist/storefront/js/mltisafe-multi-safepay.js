"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["mltisafe-multi-safepay"],{8714:(e,t,n)=>{var o,a,i,s=n(6285),r=n(4206),l=n.n(r);class u{constructor(){this.accessKey=window.accessKey,this.contextToken=window.contextToken}post(e,t={}){return l().post("/store-api/v3/multisafepay/tokenization/tokens",t,{headers:this.getBasicHeaders()}).then((function(e){return e}))}getBasicHeaders(){return{"sw-access-key":this.accessKey,"sw-context-token":this.contextToken}}}class c extends s.Z{init(){this._client=new u,this.fetchData()}fetchData(){let e=this;const t=JSON.stringify({paymentMethodId:this.options.activePaymentMethod.id,paymentMethods:this.options.paymentMethods});this._client.post("/store-api/v3/multisafepay/tokenization/tokens",t).then((function(t){const n=t.data.tokens;e.setupHtml(n)}))}setupHtml(e){const t=document.getElementById("multisafepay-checkout");var n=document.createElement("span");n.classList="custom-control custom-checkbox";var o=document.createElement("input");o.type="checkbox",o.classList="custom-control-input",o.id="saveToken",o.name="saveToken",o.setAttribute("form","confirmOrderForm");var a=document.createElement("label");if(a.htmlFor="saveToken",a.classList="custom-control-label",a.innerText="Save your credit card for next purchase",0!==e.length){n.style.display="none";var i=document.createElement("select");i.id="multisafepay-tokenization",i.classList=["custom-select"],i.style["margin-bottom"]="2rem",i.setAttribute("name","active_token"),i.setAttribute("form","confirmOrderForm"),i.addEventListener("change",(function(e){""===i.value?n.style.display="block":n.style.display="none"}));let t=document.createElement("option");t.textContent="Use new payment details",t.value="",i.appendChild(t),e.forEach(((e,t)=>{var n=document.createElement("option");n.textContent=e.name,n.value=e.token,i.appendChild(n),0===t&&n.setAttribute("selected","selected")}))}n.appendChild(o),n.appendChild(a),void 0!==i&&t.appendChild(i),t.appendChild(n)}}o=c,i={activePaymentMethod:null,paymentMethods:null},(a=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(a="options"))in o?Object.defineProperty(o,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[a]=i;class d extends s.Z{init(){"loading"!==document.readyState?this.onDOMContentLoaded():document.addEventListener("DOMContentLoaded",this.onDOMContentLoaded.bind(this));document.getElementById("confirmOrderForm").querySelector("button").addEventListener("click",this.onSubmitClick.bind(this)),document.getElementById("confirmOrderForm").addEventListener("submit",this.onSubmit.bind(this))}onDOMContentLoaded(){const e={debug:!1,env:this.options.env,apiToken:this.options.apiToken,order:{payment_options:{template_id:this.options.template_id},customer:{locale:this.options.locale,country:this.options.country},currency:this.options.currency,amount:this.options.amount},recurring:this.options.showTokenization?{model:"cardOnFile",tokens:this.options.tokens}:void 0};this.multiSafepay=new MultiSafepay(e),this.multiSafepay.init("payment",{container:"#multisafepay-checkout",gateway:this.options.gateway})}onSubmitClick(){return this.multiSafepay.getErrors().count>0?(event.preventDefault(),!1):(document.getElementById("multisafepay-payload").value=this.multiSafepay.getPaymentData().payload||"",document.getElementById("multisafepay-tokenize").value=this.multiSafepay.getPaymentData().tokenize||!1,!0)}onSubmit(){return this.multiSafepay.getErrors().count>0?(event.preventDefault(),!1):(document.getElementById("multisafepay-payload").value=this.multiSafepay.getPaymentData().payload||"",!0)}}!function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(d,"options",{tokens:null,env:"test",apiToken:null,currency:"EUR",amount:null,gateway:"CREDITCARD",country:"NL",locale:null,customerId:null,showTokenization:!1,template_id:null});class p extends s.Z{init(){"loading"!==document.readyState?this.onDOMContentLoaded():document.addEventListener("DOMContentLoaded",this.onDOMContentLoaded.bind(this))}onDOMContentLoaded(){for(const n in this.options)if("handler_multisafepay_applepaypaymenthandler"===this.options[n].formattedHandlerIdentifier){var e="paymentMethod"+n,t=document.getElementById(e).parentElement.parentElement.parentElement;t.style.display="none";try{window.ApplePaySession&&window.ApplePaySession.canMakePayments()&&(t.style.display="block")}catch(e){console.warn("MultiSafepay error when trying to initialize Apple Pay:",e)}}}}const m=window.PluginManager;m.register("MultisafepayTokenization",c,"[data-multisafepay-tokenization]"),m.register("MultisafepayComponent",d,"[data-multisafepay-component]"),m.register("MultisafepayApplePay",p,"[data-multisafepay-apple-pay]")}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=8714,e(e.s=t);var t}));e.O()}]);
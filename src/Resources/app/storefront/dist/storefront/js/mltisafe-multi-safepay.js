"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["mltisafe-multi-safepay"],{8714:(t,e,n)=>{var o,i,a,s=n(6285);class r{constructor(){this.accessKey=window.accessKey,this.contextToken=window.contextToken}post(t,e={}){return fetch("/store-api/v3/multisafepay/tokenization/tokens",{method:"POST",headers:this.getBasicHeaders(),body:JSON.stringify(e)}).then((t=>{if(!t.ok)throw new Error("HTTP error! status: "+t.status);return t.json()}))}getBasicHeaders(){return{"Content-Type":"application/json","sw-access-key":this.accessKey,"sw-context-token":this.contextToken}}}class l extends s.Z{init(){this._client=new r,this.fetchData()}fetchData(){let t=this;const e=JSON.stringify({paymentMethodId:this.options.activePaymentMethod.id,paymentMethods:this.options.paymentMethods});this._client.post("/store-api/v3/multisafepay/tokenization/tokens",e).then((function(e){const n=e.data.tokens;t.setupHtml(n)}))}setupHtml(t){const e=document.getElementById("multisafepay-checkout"),n=document.createElement("span");n.classList.add("custom-control","custom-checkbox");const o=document.createElement("input");o.type="checkbox",o.classList.add("custom-control-input"),o.id="saveToken",o.name="saveToken",o.setAttribute("form","confirmOrderForm");const i=document.createElement("label");let a;i.htmlFor="saveToken",i.classList.add("custom-control-label"),i.innerText="Save your credit card for next purchase",0!==t.length&&(n.style.display="none",a=document.createElement("select"),a.id="multisafepay-tokenization",a.classList.add("custom-select"),a.style["margin-bottom"]="2rem",a.setAttribute("name","active_token"),a.setAttribute("form","confirmOrderForm"),a.addEventListener("change",(function(){""===a.value?n.style.display="block":n.style.display="none"})),t.forEach(((t,e)=>{const n=document.createElement("option");n.textContent=t.name,n.value=t.token,a.appendChild(n),0===e&&n.setAttribute("selected","selected")}))),n.appendChild(o),n.appendChild(i),void 0!==a&&e.appendChild(a),e.appendChild(n)}}o=l,a={activePaymentMethod:null,paymentMethods:null},(i=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(i="options"))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a;class d extends s.Z{init(){"loading"!==document.readyState?this.onDOMContentLoaded():document.addEventListener("DOMContentLoaded",this.onDOMContentLoaded.bind(this)),document.getElementById("confirmOrderForm").querySelector("button").addEventListener("click",this.onSubmitClick.bind(this)),document.getElementById("confirmOrderForm").addEventListener("submit",this.onSubmit.bind(this))}onDOMContentLoaded(){const t={debug:!1,env:this.options.env,apiToken:this.options.apiToken,order:{payment_options:{template_id:this.options.template_id},customer:{locale:this.options.locale,country:this.options.country},currency:this.options.currency,amount:this.options.amount},recurring:this.options.showTokenization?{model:"cardOnFile",tokens:this.options.tokens}:void 0};this.multiSafepay=new MultiSafepay(t),this.multiSafepay.init("payment",{container:"#multisafepay-checkout",gateway:this.options.gateway})}onSubmitClick(t){return this.multiSafepay.getErrors().count>0?(t.preventDefault(),!1):(document.getElementById("multisafepay-payload").value=this.multiSafepay.getPaymentData().payload||"",document.getElementById("multisafepay-tokenize").value=this.multiSafepay.getPaymentData().tokenize||!1,!0)}onSubmit(t){return this.multiSafepay.getErrors().count>0?(t.preventDefault(),!1):(document.getElementById("multisafepay-payload").value=this.multiSafepay.getPaymentData().payload||"",!0)}}!function(t,e,n){(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(d,"options",{tokens:null,env:"test",apiToken:null,currency:"EUR",amount:null,gateway:"CREDITCARD",country:"NL",locale:null,customerId:null,showTokenization:!1,template_id:null});class c extends s.Z{init(){"loading"!==document.readyState?this.onDOMContentLoaded():document.addEventListener("DOMContentLoaded",this.onDOMContentLoaded.bind(this))}onDOMContentLoaded(){for(const t in this.options)if("handler_multisafepay_applepaypaymenthandler"===this.options[t].formattedHandlerIdentifier){const e="paymentMethod"+t,n=document.getElementById(e).parentElement.parentElement.parentElement;n.style.display="none";try{window.ApplePaySession&&window.ApplePaySession.canMakePayments()&&(n.style.display="block")}catch(t){console.warn("MultiSafepay error when trying to initialize Apple Pay:",t)}}}}const u=window.PluginManager;u.register("MultisafepayTokenization",l,"[data-multisafepay-tokenization]"),u.register("MultisafepayComponent",d,"[data-multisafepay-component]"),u.register("MultisafepayApplePay",c,"[data-multisafepay-apple-pay]")}},t=>{t.O(0,["vendor-node","vendor-shared"],(()=>{return e=8714,t(t.s=e);var e}));t.O()}]);
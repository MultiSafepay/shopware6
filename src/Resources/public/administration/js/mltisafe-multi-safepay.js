!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/bundles/mltisafemultisafepay/",n(n.s="ADUy")}({ADUy:function(e,t,n){"use strict";n.r(t);n("I0jd");var a=n("poD7"),o=n.n(a),r=Shopware,i=r.Component,s=r.Mixin,u=Shopware.Data.Criteria;i.register("multisafepay-refund",{template:o.a,inject:["repositoryFactory","orderService","stateStyleDataProviderService","multiSafepayApiService"],mixins:[s.getByName("notification")],props:{orderId:{type:String,required:!0}},data:function(){return{amount:null,isLoading:null,versionContext:null,order:null,maxRefundableAmount:0,isRefundAllowed:!0,refundedAmount:0,showModal:!1,isRefundDisabled:!1}},watch:{orderId:function(){this.createdComponent()},amount:function(){this.amount=parseFloat(this.amount).toFixed(2)},refundedAmount:function(){this.refundedAmount=parseFloat(this.refundedAmount).toFixed(2)}},methods:{closeModal:function(){this.showModal=!1},showRefundModal:function(){this.amount<.01?this.createNotificationWarning({title:"Invalid amount",message:"Fill in a valid amount"}):this.showModal=!0},applyRefund:function(){var e=this;this.closeModal(),this.multiSafepayApiService.refund(this.amount,this.orderId).then((function(t){!1!==t.status?(e.createNotificationSuccess({title:"Success",message:"Successfully refunded"}),e.reloadEntityData()):e.createNotificationError({title:"Failed to refund",message:t.message})}))},createdComponent:function(){this.versionContext=Shopware.Context.api,this.reloadEntityData()},reloadEntityData:function(){var e=this;return this.isLoading=!0,this.orderRepository.get(this.orderId,this.versionContext,this.orderCriteria).then((function(t){return e.order=t,e.multiSafepayApiService.getRefundData(e.order.id).then((function(t){e.isRefundAllowed=t.isAllowed,e.refundedAmount=t.refundedAmount,e.maxRefundableAmount=e.order.amountTotal-e.refundedAmount,e.isRefundDisabled=e.order.amountTotal-e.refundedAmount==0,e.isLoading=!1})).catch((function(){e.isRefundAllowed=!1})),Promise.resolve()})).catch((function(){return Promise.reject()}))}},computed:{orderRepository:function(){return this.repositoryFactory.create("order")},orderCriteria:function(){var e=new u(this.page,this.limit);return e.addAssociation("currency"),e}},created:function(){this.createdComponent()}});var l=n("aZvQ"),c=n.n(l),p=Shopware,d=p.Component,f=p.Mixin;d.register("multisafepay-verify-api-key",{template:c.a,inject:["multiSafepayApiService"],mixins:[f.getByName("notification")],data:function(){return{isLoading:!1}},computed:{globalPluginConfig:function(){var e=this.$parent.$parent.$parent.actualConfigData;return e?e.null:this.$parent.$parent.$parent.$parent.actualConfigData?this.$parent.$parent.$parent.$parent.actualConfigData.null:this.$parent.$parent.$parent.$parent.$parent.actualConfigData?this.$parent.$parent.$parent.$parent.$parent.actualConfigData.null:void 0},actualPluginConfig:function(){if(this.$parent.$parent.$parent.currentSalesChannelId){var e=this.$parent.$parent.$parent.currentSalesChannelId;return this.$parent.$parent.$parent.actualConfigData[e]}if(this.$parent.$parent.$parent.$parent.currentSalesChannelId){var t=this.$parent.$parent.$parent.$parent.currentSalesChannelId;return this.$parent.$parent.$parent.$parent.actualConfigData[t]}if(this.$parent.$parent.$parent.$parent.$parent.currentSalesChannelId){var n=this.$parent.$parent.$parent.$parent.$parent.currentSalesChannelId;return this.$parent.$parent.$parent.$parent.$parent.actualConfigData[n]}return null}},methods:{check:function(){var e=this;this.isLoading=!0,this.multiSafepayApiService.verifyApiKey(this.globalPluginConfig,this.actualPluginConfig).then((function(t){if(!1===t.success)return e.createNotificationWarning({title:"MultiSafepay",message:e.$tc("multisafepay-verify-api-key.error")}),void(e.isLoading=!1);e.createNotificationSuccess({title:"MultiSafepay",message:e.$tc("multisafepay-verify-api-key.success")}),e.isLoading=!1}))}}});n("xtVb");var m=n("hhDN"),h=n.n(m);Shopware.Component.register("multisafepay-support",{template:h.a});var y=n("NeQ9"),g=n.n(y);Shopware.Component.override("sw-settings-payment-detail",{template:g.a,data:function(){return{tokenizationSupported:!1,componentSupported:!1}},inject:["multiSafepayApiService"],watch:{paymentMethod:function(){this.paymentMethod||(this.paymentMethod={}),this.paymentMethod.id||(this.paymentMethod.id=null),this.paymentMethod.customFields||(this.paymentMethod.customFields={}),this.paymentMethod.customFields.tokenization||(this.paymentMethod.customFields.tokenization=!1),this.paymentMethod.customFields.component||(this.paymentMethod.customFields.component=!1),this.reloadEntityData()}},mounted:function(){this.reloadEntityData()},methods:{reloadEntityData:function(){var e=this;this.multiSafepayApiService.isTokenizationAllowed(this.$route.params.id).then((function(t){e.tokenizationSupported=t.supported})),this.multiSafepayApiService.isComponentAllowed(this.$route.params.id).then((function(t){e.componentSupported=t.supported}))}}});var v=n("NpKD"),b=n.n(v);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=A(e);if(t){var o=A(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return C(this,n)}}function C(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=Shopware.Classes.ApiService,x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(r,e);var t,n,a,o=k(r);function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"multisafepay";return w(this,r),o.call(this,e,t,n)}return t=r,(n=[{key:"refund",value:function(e,t){var n="".concat(this.getApiBasePath(),"/refund");return this.httpClient.post(n,{amount:100*e,orderId:t},{headers:this.getBasicHeaders()}).then((function(e){return M.handleResponse(e)})).catch((function(e){return M.handleResponse(e)}))}},{key:"getRefundData",value:function(e){var t="".concat(this.getApiBasePath(),"/get-refund-data");return this.httpClient.post(t,{orderId:e},{headers:this.getBasicHeaders()}).then((function(e){return M.handleResponse(e)}))}},{key:"verifyApiKey",value:function(e,t){var n="".concat(this.getApiBasePath(),"/verify-api-key"),a=this.getBasicHeaders();return this.httpClient.post(n,{globalPluginConfig:e,actualPluginConfig:t},{headers:a}).then((function(e){return M.handleResponse(e)}))}},{key:"isTokenizationAllowed",value:function(e){var t="".concat(this.getApiBasePath(),"/tokenization-allowed");return this.httpClient.post(t,{paymentMethodId:e},{headers:this.getBasicHeaders()}).then((function(e){return M.handleResponse(e)})).catch((function(e){return M.handleResponse(e)}))}},{key:"isComponentAllowed",value:function(e){var t="".concat(this.getApiBasePath(),"/component-allowed");return this.httpClient.post(t,{paymentMethodId:e},{headers:this.getBasicHeaders()}).then((function(e){return M.handleResponse(e)})).catch((function(e){return M.handleResponse(e)}))}}])&&_(t.prototype,n),a&&_(t,a),Object.defineProperty(t,"prototype",{writable:!1}),r}(M),D=n("vxeO"),R=n("r6r3"),P=Shopware,I=P.Component,O=P.Application;I.override("sw-order-detail-base",{template:b.a}),O.addServiceProvider("multiSafepayApiService",(function(e){var t=O.getContainer("init");return new x(t.httpClient,e.loginService)})),Shopware.Locale.extend("de-DE",D),Shopware.Locale.extend("en-GB",R)},CRug:function(e,t,n){},I0jd:function(e,t,n){var a=n("CRug");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("ad8c5690",a,!0,{})},NeQ9:function(e,t){e.exports='{% block sw_settings_payment_detail_content_field_after_order_enabled %}\n    {% parent %}\n    <sw-field\n            v-if="tokenizationSupported"\n            :is-loading="isLoading"\n            type="switch"\n            v-model="paymentMethod.customFields.tokenization"\n            label="Tokenization"\n            :help-text="$tc(\'multisafepay-tokenization.help_text\')"\n    ></sw-field>\n    <sw-field\n            v-if="componentSupported"\n            :is-loading="isLoading"\n            type="switch"\n            v-model="paymentMethod.customFields.component"\n            label="Component"\n            :help-text="$tc(\'multisafepay-component.help_text\')"\n    ></sw-field>\n{% endblock %}\n'},NpKD:function(e,t){e.exports='{% block sw_order_detail_base_line_items_card %}\n    {% parent %}\n\n    <multisafepay-refund :orderId="orderId"/>\n{% endblock %}\n'},SZ7m:function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},o=0;o<t.length;o++){var r=t[o],i=r[0],s={id:e+":"+o,css:r[1],media:r[2],sourceMap:r[3]};a[i]?a[i].parts.push(s):n.push(a[i]={id:i,parts:[s]})}return n}n.r(t),n.d(t,"default",(function(){return m}));var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var r={},i=o&&(document.head||document.getElementsByTagName("head")[0]),s=null,u=0,l=!1,c=function(){},p=null,d="data-vue-ssr-id",f="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function m(e,t,n,o){l=n,p=o||{};var i=a(e,t);return h(i),function(t){for(var n=[],o=0;o<i.length;o++){var s=i[o];(u=r[s.id]).refs--,n.push(u)}t?h(i=a(e,t)):i=[];for(o=0;o<n.length;o++){var u;if(0===(u=n[o]).refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete r[u.id]}}}}function h(e){for(var t=0;t<e.length;t++){var n=e[t],a=r[n.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](n.parts[o]);for(;o<n.parts.length;o++)a.parts.push(g(n.parts[o]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var i=[];for(o=0;o<n.parts.length;o++)i.push(g(n.parts[o]));r[n.id]={id:n.id,refs:1,parts:i}}}}function y(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function g(e){var t,n,a=document.querySelector("style["+d+'~="'+e.id+'"]');if(a){if(l)return c;a.parentNode.removeChild(a)}if(f){var o=u++;a=s||(s=y()),t=S.bind(null,a,o,!1),n=S.bind(null,a,o,!0)}else a=y(),t=w.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}var v,b=(v=[],function(e,t){return v[e]=t,v.filter(Boolean).join("\n")});function S(e,t,n,a){var o=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var r=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(r,i[t]):e.appendChild(r)}}function w(e,t){var n=t.css,a=t.media,o=t.sourceMap;if(a&&e.setAttribute("media",a),p.ssrId&&e.setAttribute(d,t.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},aZvQ:function(e,t){e.exports='<div>\n    <sw-button-process\n        :isLoading="isLoading"\n        @click="check"\n    >{{ $tc(\'multisafepay-verify-api-key.apiButton\') }}</sw-button-process>\n</div>\n'},hhDN:function(e,t){e.exports='<template>\n    <div id="multisafepay-support">\n        <h2 class="multisafepay-title">{{ $tc("msp-support.documentation") }}</h2>\n        <p>{{ $tc("msp-support.read_docs") }}:</p>\n        <ul class="multisafepay-ul">\n            <li>\n                <a href="https://docs.multisafepay.com/docs/shopware#shopware-6" target="_blank" rel="noopener">\n                    {{ $tc(\'msp-support.manual\') }}\n                </a>\n            </li>\n            <li>\n                <a href="https://github.com/MultiSafepay/shopware6/blob/master/CHANGELOG.md"\n                   target="_blank" rel="noopener">\n                    {{ $tc("msp-support.changelog") }}\n                </a>\n            </li>\n        </ul>\n        <p class="mt-1">{{ $tc("msp-support.for_developers") }}:</p>\n        <ul class="multisafepay-ul">\n            <li>\n                <a href="https://docs.multisafepay.com/reference/introduction" target="_blank" rel="noopener">\n                    {{ $tc("msp-support.api_documentation") }}\n                </a>\n            </li>\n            <li>\n                <a href="https://github.com/MultiSafepay/Shopware6" target="_blank" rel="noopener">\n                    MultiSafepay Github\n                </a>\n            </li>\n        </ul>\n        <h2 class="mt-2">{{ $tc("msp-support.account")}}</h2>\n        <p>\n            {{ $tc("msp-support.multisafepay_account_needed") }}\n            <br/>\n            <span v-html=\'$tc("msp-support.multisafepay_test_account")\'></span>\n        </p>\n        <p class="mt-2">\n            <span v-html=\'$tc("msp-support.multisafepay_live_account")\'></span>\n        </p>\n        <ul class="multisafepay-ul-none">\n            <li>\n                {{ $tc("msp-support.telephone") }}:\n                <a href="tel:+31208500501">\n                    +31 (0)20 - 8500501\n                </a>\n            </li>\n            <li>\n                {{ $tc("msp-support.e-mail") }}:\n                <a href="mailto:sales@multisafepay.com">\n                    sales@multisafepay.com\n                </a>\n            </li>\n        </ul>\n        <h2 class="mt-2">{{ $tc("msp-support.contact") }}</h2>\n        <p>\n            {{ $tc("msp-support.multisafepay_assistance_integration_team") }}\n        </p>\n        <ul class="multisafepay-ul-none">\n            <li>\n                {{ $tc("msp-support.telephone") }}:\n                <a href="tel:+31208500500">\n                    +31 (0)20 - 8500500\n                </a>\n            </li>\n            <li>\n                {{ $tc("msp-support.e-mail") }}:\n                <a href="mailto:integration@multisafepay.com">\n                    integration@multisafepay.com\n                </a>\n            </li>\n        </ul>\n    </div>\n\n</template>\n'},poD7:function(e,t){e.exports='<template>\n    <sw-card title="Refund"\n             v-show="isRefundAllowed"\n             :isLoading="isLoading"\n             class="sw-order-detail-base__line-item-grid-card">\n        <sw-number-field type="number" label="Amount" v-model="amount"\n                         placeholder="0.00" numberType="float" step="0.01"\n                         :max="maxRefundableAmount" :disabled="isRefundDisabled"/>\n        <sw-button variant="primary" @click="showRefundModal()" :disabled="isRefundDisabled">Refund</sw-button>\n        <span class="float-right">\n            <strong>Amount refunded: {{ order ? order.currency.symbol : \'currency\' }}&nbsp;{{ refundedAmount }}</strong>\n        </span>\n        <sw-modal v-show="showModal" title="MultiSafepay refund" variant="small" @modal-close="closeModal()">\n            Are you sure you want to refund {{ order ? order.currency.symbol : \'currency\' }}{{ this.amount }}?\n            <template slot="modal-footer">\n\n                <sw-button @click="closeModal()" size="small">\n                    {{ $tc(\'global.default.cancel\') }}\n                </sw-button>\n\n                <sw-button @click="applyRefund()"\n                           size="small"\n                           variant="primary">\n                    {{ $tc(\'global.default.apply\') }}\n                </sw-button>\n\n            </template>\n        </sw-modal>\n    </sw-card>\n</template>\n'},r6r3:function(e){e.exports=JSON.parse('{"multisafepay-verify-api-key":{"success":"Connection was successfully established","error":"Connection could not be established. Please check your API credentials","apiButton":"Validate API credentials"},"msp-support":{"documentation":"Documentation","api_documentation":"API Documentation","read_docs":"Read our documentation for more information about MultiSafepay and how to get started","manual":"Manual","changelog":"Changelog","faq":"FAQ","for_developers":"For developers","account":"Account","e-mail":"E-mail","telephone":"Telephone","contact":"Contact","multisafepay_account_needed":"To use this plugin you need a MultiSafepay account.","multisafepay_test_account":"If you would like to have a clear overview of what MultiSafepay has to offer, feel free to create a <a href=\\"https://testmerchant.multisafepay.com/signup\\" target=\\"_blank\\" rel=\\"noopener\\">test account</a>.","multisafepay_assistance_integration_team":"Need assistance? Feel free to contact our integration team:","multisafepay_live_account":"If you would like to set up a live account, feel free to create a <a href=\\"https://merchant.multisafepay.com/signup\\" target=\\"_blank\\" rel=\\"noopener\\">live account</a> or contact the MultiSafepay Sales department:"},"multisafepay-tokenization":{"help_text":"Check out our <a href=\\"https://docs.multisafepay.com/docs/recurring-payments/\\" target=\\"_blank\\" style=\\"color:#fff\\">documentation center</a> to found more about tokenization."},"multisafepay-component":{"help_text":"Check out our <a href=\\"https://docs.multisafepay.com/docs/payment-components/\\" target=\\"_blank\\" style=\\"color:#fff\\">documentation center</a> to found more about Payment Component."}}')},vxeO:function(e){e.exports=JSON.parse('{"multisafepay-verify-api-key":{"success":"Die Verbindung wurde erfolgreich hergestellt","error":"Verbindung konnte nicht hergestellt werden. Bitte überprüfen Sie Ihre API-Anmeldeinformationen","apiButton":"API Verbindung testen"},"msp-support":{"documentation":"Dokumentation","api_documentation":"API Dokumentation","read_docs":"Lesen Sie in unserem Dokumentationen mehr über MultiSafepay und wie Sie mit uns starten können","manual":"Anleitung","changelog":"Änderungsprotokoll","faq":"FAQ","for_developers":"Für Entwickler","account":"Account","e-mail":"E-Mail","telephone":"Telefon","contact":"Kontakt","multisafepay_account_needed":"Um dieses Plugin nutzen zu können benötigen Sie einen MultiSafepay-Account.","multisafepay_test_account":"Wenn Sie einen genauen Überblick über die Services von MultiSafepay bekommen möchten, können Sie einfach einen <a href=\\"https://testmerchant.multisafepay.com/signup\\" target=\\"_blank\\" rel=\\"noopener\\">Test-Account</a> eröffnen.","multisafepay_assistance_integration_team":"Sie brauchen Hilfe? Kontaktieren Sie unser Integrations-Team:","multisafepay_live_account":"Wenn Sie einen Account eröffnen wollen, können Sie einfach einen <a href=\\"https://merchant.multisafepay.com/signup\\" target=\\"_blank\\" rel=\\"noopener\\">Live-Account</a> eröffnen oder kontaktieren Sie das MultiSafepay Sales-Department:"},"multisafepay-tokenization":{"help_text":"Weitere Informationen zur Tokenisierung finden Sie in unserem <a href=\\"https://docs.multisafepay.com/docs/recurring-payments/\\" target=\\"_blank\\" style=\\"color:#fff\\">Dokumentationscenter.</a>"},"multisafepay-component":{"help_text":"Sehen Sie sich unser <a href=\\"https://docs.multisafepay.com/docs/payment-components\\" target=\\"_blank\\" style=\\"color:#fff\\">Dokumentationscenter.</a> an, um mehr über die Zahlungskomponente zu erfahren."}}')},x1Ww:function(e,t,n){},xtVb:function(e,t,n){var a=n("x1Ww");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("893d1baa",a,!0,{})}});